<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="longevity, Scala, NoSQL, MongoDB, Cassandra, database, Domain Driven Design" />
    <meta name="description" content="A Persistence Framework for Scala and NoSQL" />

    <meta property="og:title" content="longevity"/>
    <meta property="og:description" content="A Persistence Framework for Scala and NoSQL"/>
    <meta property="og:image" content="http://longevityframework.org/images/longevity.png" />
    <meta property='og:url' content="http://longevityframework.org/" />

    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/stylesheets/longevity.css">
    <link rel="stylesheet" href="/stylesheets/stylesheet.css">
    <link rel="stylesheet" href="/stylesheets/github-light.css">
    <link rel="stylesheet" href="/stylesheets/print.css" media="print">
    <link rel="stylesheet" href="/stylesheets/emacs.css">

    <link rel="icon" type="image/png" href="http://longevityframework.org/favicon.png" >

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-42481814-3', 'auto');
      ga('send', 'pageview');
    </script>

    
    <title>configuring your longevity context</title>
    
  </head>

  <body>
    <header>
      <div class="inner">
        <h1><a href="/" class="nostyle">longevity</a></h1>
        <h2>
          A Persistence Framework for Scala and NoSQL
        </h2>
        <a href="https://github.com/longevityframework/longevity" class="button">
          <small>View project on</small> GitHub
        </a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          
          <h1> configuring your longevity context </h1>
          
          <p>Longevity uses <a href="https://github.com/typesafehub/config">Typesafe
Config</a> to help you configure
your <code class="highlighter-rouge">LongevityContext</code>. The default configuration settings are found
in the <code class="highlighter-rouge">reference.conf</code> file included in the longevity jar. (Here’s
the <a href="https://github.com/longevityframework/longevity/blob/master/longevity/src/main/resources/reference.conf">latest version on
GitHub</a>.)</p>

<p>The typical way to supply configuration to your application is to
override these defaults in your <code class="highlighter-rouge">application.conf</code> file, located on
your classpath.</p>

<p>It’s possible to have multiple domain models in the same application, and to supply the
<code class="highlighter-rouge">LongevityContexts</code> for these models with different configurations. For instance, suppose we have a
core domain in our blogging application:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">package</span> <span class="nn">bloggingapp.core</span>

<span class="k">import</span> <span class="nn">longevity.model.annotations.domainModel</span>

<span class="k">package</span> <span class="nn">object</span> <span class="n">model</span> <span class="o">{</span>

  <span class="nd">@domainModel</span> <span class="k">trait</span> <span class="nc">BloggingDomain</span>

<span class="o">}</span>
</code></pre>
</div>

<p>And a supporting subdomain for managing accounts:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">package</span> <span class="nn">bloggingapp.accounts</span>

<span class="k">import</span> <span class="nn">longevity.model.annotations.domainModel</span>

<span class="k">package</span> <span class="nn">object</span> <span class="n">model</span> <span class="o">{</span>

  <span class="nd">@domainModel</span> <span class="k">trait</span> <span class="nc">AccountsSubdomain</span>

<span class="o">}</span>
</code></pre>
</div>

<p>You can supply separate <code class="highlighter-rouge">com.typesafe.config.Config</code> objects to each
<code class="highlighter-rouge">LongevityContext</code> like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">bloggingapp.accounts.model.AccountsSubdomain</span>
<span class="k">import</span> <span class="nn">bloggingapp.core.model.BloggingDomain</span>
<span class="k">import</span> <span class="nn">com.typesafe.config.Config</span>
<span class="k">import</span> <span class="nn">longevity.context.LongevityContext</span>
<span class="k">import</span> <span class="nn">scala.concurrent.ExecutionContext.Implicits.global</span>
<span class="k">import</span> <span class="nn">scala.concurrent.Future</span>

<span class="k">val</span> <span class="n">bloggingConfig</span><span class="k">:</span> <span class="kt">Config</span> <span class="o">=</span> <span class="n">loadBloggingConfig</span><span class="o">()</span>
<span class="k">val</span> <span class="n">bloggingContext</span> <span class="k">=</span> <span class="nc">LongevityContext</span><span class="o">[</span><span class="kt">Future</span>, <span class="kt">BloggingDomain</span><span class="o">](</span><span class="n">bloggingConfig</span><span class="o">)</span>

<span class="k">val</span> <span class="n">accountsConfig</span><span class="k">:</span> <span class="kt">Config</span> <span class="o">=</span> <span class="n">loadAccountsConfig</span><span class="o">()</span>
<span class="k">val</span> <span class="n">accountsContext</span> <span class="k">=</span> <span class="nc">LongevityContext</span><span class="o">[</span><span class="kt">Future</span>, <span class="kt">AccountsSubdomain</span><span class="o">](</span><span class="n">accountsConfig</span><span class="o">)</span>
</code></pre>
</div>

<p>Please see the <a href="https://github.com/typesafehub/config#overview">Typesafe Config documentation</a> for
more information on the different ways you can manage your configuration.</p>

<p>Longevity converts the Typesafe Config into a <code class="highlighter-rouge">LongevityConfig</code> case
class internally. You can use case class configuration if you
prefer. Here we use the <code class="highlighter-rouge">LongevityConfig</code> case class to define the
same configuration as found in the <code class="highlighter-rouge">reference.conf</code> file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">longevity.context.CassandraConfig</span>
<span class="k">import</span> <span class="nn">longevity.context.InMem</span>
<span class="k">import</span> <span class="nn">longevity.context.JdbcConfig</span>
<span class="k">import</span> <span class="nn">longevity.context.LongevityConfig</span>
<span class="k">import</span> <span class="nn">longevity.context.MongoConfig</span>
<span class="k">import</span> <span class="nn">longevity.context.TestConfig</span>

<span class="k">val</span> <span class="n">longevityConfig</span> <span class="k">=</span> <span class="nc">LongevityConfig</span><span class="o">(</span>
  <span class="n">backEnd</span> <span class="k">=</span> <span class="nc">InMem</span><span class="o">,</span> <span class="c1">// one of Cassandra, InMem, JDBC, MongoDB, SQLite
</span>  <span class="n">autoOpenConnection</span> <span class="k">=</span> <span class="kc">false</span><span class="o">,</span>
  <span class="n">autoCreateSchema</span> <span class="k">=</span> <span class="kc">false</span><span class="o">,</span>
  <span class="n">optimisticLocking</span> <span class="k">=</span> <span class="kc">false</span><span class="o">,</span>
  <span class="n">writeTimestamps</span> <span class="k">=</span> <span class="kc">false</span><span class="o">,</span>
  <span class="n">cassandra</span> <span class="k">=</span> <span class="nc">CassandraConfig</span><span class="o">(</span>
    <span class="n">autoCreateKeyspace</span> <span class="k">=</span> <span class="kc">false</span><span class="o">,</span>
    <span class="n">address</span> <span class="k">=</span> <span class="s">"127.0.0.1"</span><span class="o">,</span>
    <span class="n">credentials</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
    <span class="n">keyspace</span> <span class="k">=</span> <span class="s">"longevity_main"</span><span class="o">,</span>
    <span class="n">replicationFactor</span> <span class="k">=</span> <span class="mi">1</span><span class="o">),</span>
  <span class="n">mongodb</span> <span class="k">=</span> <span class="nc">MongoConfig</span><span class="o">(</span>
    <span class="n">uri</span> <span class="k">=</span> <span class="s">"mongodb://127.0.0.1:27017"</span><span class="o">,</span>
    <span class="n">db</span> <span class="k">=</span> <span class="s">"longevity_main"</span><span class="o">),</span>
  <span class="n">jdbc</span> <span class="k">=</span> <span class="nc">JdbcConfig</span><span class="o">(</span>
    <span class="n">driverClass</span> <span class="k">=</span> <span class="s">"org.sqlite.JDBC"</span>
    <span class="n">url</span> <span class="k">=</span> <span class="s">"jdbc:sqlite:longevity_main.db"</span><span class="o">),</span>
  <span class="n">test</span> <span class="k">=</span> <span class="nc">TestConfig</span><span class="o">(</span>
    <span class="n">cassandra</span> <span class="k">=</span> <span class="nc">CassandraConfig</span><span class="o">(</span>
      <span class="n">autoCreateKeyspace</span> <span class="k">=</span> <span class="kc">false</span><span class="o">,</span>
      <span class="n">address</span> <span class="k">=</span> <span class="s">"127.0.0.1"</span><span class="o">,</span>
      <span class="n">credentials</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
      <span class="n">keyspace</span> <span class="k">=</span> <span class="s">"longevity_test"</span><span class="o">,</span>
      <span class="n">replicationFactor</span> <span class="k">=</span> <span class="mi">1</span><span class="o">),</span>
    <span class="n">mongodb</span> <span class="k">=</span> <span class="nc">MongoConfig</span><span class="o">(</span>
      <span class="n">uri</span> <span class="k">=</span> <span class="s">"mongodb://127.0.0.1:27017"</span><span class="o">,</span>
      <span class="n">db</span> <span class="k">=</span> <span class="s">"longevity_test"</span><span class="o">),</span>
    <span class="n">jdbc</span> <span class="k">=</span> <span class="nc">JdbcConfig</span><span class="o">(</span>
      <span class="n">driverClass</span> <span class="k">=</span> <span class="s">"org.sqlite.JDBC"</span>
      <span class="n">url</span> <span class="k">=</span> <span class="s">"jdbc:sqlite:longevity_test.db"</span><span class="o">)))</span>

<span class="k">val</span> <span class="n">bloggingContext</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">LongevityContext</span><span class="o">[</span><span class="kt">BloggingDomain</span><span class="o">](</span><span class="n">longevityConfig</span><span class="o">)</span>
</code></pre>
</div>

<p>The most important configuration setting is <code class="highlighter-rouge">longevity.backEnd</code>. This
is where you choose your database. Right now, the options are
<code class="highlighter-rouge">Cassandra</code>, <code class="highlighter-rouge">JDBC</code>, <code class="highlighter-rouge">InMem</code>, <code class="highlighter-rouge">MongoDB</code>, and <code class="highlighter-rouge">SQLite</code>.</p>

<p>The <code class="highlighter-rouge">JDBC</code> back end is a generic back end that you can use for any
databases with a JDBC driver. Unfortunately, we are not able to
provide support for any JDBC driver other than SQLite, because we have
no way of writing integration tests against this back end without
specifying the JDBC driver, and the longevity framework team (i.e.,
me) already has their hands full supporting the other back ends. That
said, we would be <em>more</em> than happy to give you help and advice in
troubleshooting any problems. In fact, we’ve made it as easy as
possible for you to build and maintain your own JDBC-flavored back
end. See <a href="https://github.com/longevityframework/longevity/wiki/How-to-create-a-new-JDBC-back-end">these
instructions</a>
for details.</p>

<div style="display: flex;
            justify-content: space-between;
            text-align: center;
            margin-left: 3em;
            margin-right: 3em;">

<div style="min-width: 10em">

  prev: <a href="effects.html">choosing your effect</a>

</div>

<div style="min-width: 10em">

up: <a href=".">the longevity context</a>

</div>

<div style="min-width: 10em">

next: <a href="repos.html">repositories in the context</a>

</div>

</div>


        </section>

        <aside id="sidebar">
          <a href="/feature-list.html"                                      class="button">Feature List    </a>
          <a href="https://youtu.be/AJMETrjSzzY"                            class="button">Video Demo      </a>
          <a href="/manual"                                                 class="button">User Manual     </a>
          <a href="/getting-started"                                        class="button">Getting Started </a>
          <a href="/api/longevity"                                          class="button">Scaladocs       </a>
          <a href="https://groups.google.com/forum/#!forum/longevity-users" class="button">Discussion Forum</a>
          <a href="/resources.html"                                         class="button">Resources       </a>
        </aside>
      </div>
    </div>
  
  </body>
</html>
